<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Erasure.Soundness</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a>  <a id="26" class="Symbol">#-}</a>
<a id="30" class="Keyword">open</a> <a id="35" class="Keyword">import</a> <a id="42" href="Definition.Modality.Erasure.html" class="Module">Definition.Modality.Erasure</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Definition.Typed.EqualityRelation.html" class="Module">Definition.Typed.EqualityRelation</a>


<a id="119" class="Keyword">module</a> <a id="126" href="Erasure.Soundness.html" class="Module">Erasure.Soundness</a> <a id="144" class="Symbol">{{</a><a id="146" href="Erasure.Soundness.html#146" class="Bound">eqrel</a> <a id="152" class="Symbol">:</a> <a id="154" href="Definition.Typed.EqualityRelation.html#518" class="Record">EqRelSet</a> <a id="163" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a><a id="170" class="Symbol">}}</a> <a id="173" class="Keyword">where</a>
<a id="179" class="Keyword">open</a> <a id="184" href="Definition.Typed.EqualityRelation.html#518" class="Module">EqRelSet</a> <a id="193" class="Symbol">{{...}}</a>

<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Definition.Untyped.html" class="Module">Definition.Untyped</a> <a id="233" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a> <a id="241" class="Keyword">hiding</a> <a id="248" class="Symbol">(</a>_∷_<a id="252" class="Symbol">)</a>
<a id="254" class="Keyword">open</a> <a id="259" class="Keyword">import</a> <a id="266" href="Definition.Untyped.Properties.html" class="Module">Definition.Untyped.Properties</a> <a id="296" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a>
<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Definition.Typed.html" class="Module">Definition.Typed</a> <a id="333" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a>
<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Definition.Typed.RedSteps.html" class="Module">Definition.Typed.RedSteps</a> <a id="379" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Definition.Typed.Properties.html" class="Module">Definition.Typed.Properties</a> <a id="427" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a>
<a id="435" class="Keyword">open</a> <a id="440" class="Keyword">import</a> <a id="447" href="Definition.Typed.Consequences.Syntactic.html" class="Module">Definition.Typed.Consequences.Syntactic</a> <a id="487" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a>
<a id="495" class="Keyword">open</a> <a id="500" class="Keyword">import</a> <a id="507" href="Definition.Typed.Consequences.Inversion.html" class="Module">Definition.Typed.Consequences.Inversion</a> <a id="547" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a>
<a id="555" class="Keyword">open</a> <a id="560" class="Keyword">import</a> <a id="567" href="Definition.LogicalRelation.html" class="Module">Definition.LogicalRelation</a> <a id="594" href="Definition.Modality.Erasure.html#242" class="Datatype">Erasure</a>
<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="Definition.Modality.Context.html" class="Module">Definition.Modality.Context</a> <a id="642" href="Definition.Modality.Erasure.html#6954" class="Function">ErasureModality</a>
<a id="658" class="Keyword">open</a> <a id="663" class="Keyword">import</a> <a id="670" href="Definition.Modality.Usage.html" class="Module">Definition.Modality.Usage</a> <a id="696" href="Definition.Modality.Erasure.html#6954" class="Function">ErasureModality</a>

<a id="713" class="Keyword">import</a> <a id="720" href="Erasure.Target.html" class="Module">Erasure.Target</a> <a id="735" class="Symbol">as</a> <a id="738" class="Module">T</a>
<a id="740" class="Keyword">open</a> <a id="745" class="Keyword">import</a> <a id="752" href="Erasure.Target.Properties.Reduction.html" class="Module">Erasure.Target.Properties.Reduction</a>
<a id="788" class="Keyword">open</a> <a id="793" class="Keyword">import</a> <a id="800" href="Erasure.Extraction.html" class="Module">Erasure.Extraction</a>
<a id="819" class="Keyword">open</a> <a id="824" class="Keyword">import</a> <a id="831" href="Erasure.LogicalRelation.html" class="Module">Erasure.LogicalRelation</a>
<a id="855" class="Keyword">open</a> <a id="860" class="Keyword">import</a> <a id="867" href="Erasure.LogicalRelation.Fundamental.html" class="Module">Erasure.LogicalRelation.Fundamental</a>
<a id="903" class="Keyword">open</a> <a id="908" class="Keyword">import</a> <a id="915" href="Erasure.LogicalRelation.Irrelevance.html" class="Module">Erasure.LogicalRelation.Irrelevance</a>

<a id="952" class="Keyword">open</a> <a id="957" class="Keyword">import</a> <a id="964" href="Tools.Nat.html" class="Module">Tools.Nat</a>
<a id="974" class="Keyword">open</a> <a id="979" class="Keyword">import</a> <a id="986" href="Tools.Product.html" class="Module">Tools.Product</a>
<a id="1000" class="Keyword">open</a> <a id="1005" class="Keyword">import</a> <a id="1012" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>

<a id="1041" class="Keyword">private</a>
  <a id="1051" class="Keyword">variable</a>
    <a id="1064" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="1066" class="Symbol">:</a> <a id="1068" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a>
    <a id="1076" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="1078" href="Erasure.Soundness.html#1078" class="Generalizable">t′</a> <a id="1081" href="Erasure.Soundness.html#1081" class="Generalizable">F</a> <a id="1083" class="Symbol">:</a> <a id="1085" href="Definition.Untyped.html#2016" class="Datatype">Term</a> <a id="1090" href="Erasure.Soundness.html#1064" class="Generalizable">n</a>
    <a id="1096" href="Erasure.Soundness.html#1096" class="Generalizable">G</a> <a id="1098" class="Symbol">:</a> <a id="1100" href="Definition.Untyped.html#2016" class="Datatype">Term</a> <a id="1105" class="Symbol">(</a><a id="1106" href="Tools.Nat.html#406" class="InductiveConstructor">1+</a> <a id="1109" href="Erasure.Soundness.html#1064" class="Generalizable">n</a><a id="1110" class="Symbol">)</a>
    <a id="1116" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="1118" href="Erasure.Soundness.html#1118" class="Generalizable">v′</a> <a id="1121" class="Symbol">:</a> <a id="1123" href="Erasure.Target.html#302" class="Datatype">T.Term</a> <a id="1130" href="Erasure.Soundness.html#1064" class="Generalizable">n</a>

<a id="1133" class="Comment">-- WH reduction soundness of natural numbers</a>

<a id="1179" class="Comment">-- Canonical representation of natural numbers</a>

<a id="sucᵏ"></a><a id="1227" href="Erasure.Soundness.html#1227" class="Function">sucᵏ</a> <a id="1232" class="Symbol">:</a> <a id="1234" class="Symbol">(</a><a id="1235" href="Erasure.Soundness.html#1235" class="Bound">k</a> <a id="1237" class="Symbol">:</a> <a id="1239" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a><a id="1242" class="Symbol">)</a> <a id="1244" class="Symbol">→</a> <a id="1246" href="Definition.Untyped.html#2016" class="Datatype">Term</a> <a id="1251" href="Erasure.Soundness.html#1064" class="Generalizable">n</a>
<a id="1253" href="Erasure.Soundness.html#1227" class="Function">sucᵏ</a> <a id="1258" class="Number">0</a>      <a id="1265" class="Symbol">=</a> <a id="1267" href="Definition.Untyped.html#3763" class="Function">zero</a>
<a id="1272" href="Erasure.Soundness.html#1227" class="Function">sucᵏ</a> <a id="1277" class="Symbol">(</a><a id="1278" href="Tools.Nat.html#406" class="InductiveConstructor">1+</a> <a id="1281" href="Erasure.Soundness.html#1281" class="Bound">n</a><a id="1282" class="Symbol">)</a> <a id="1284" class="Symbol">=</a> <a id="1286" href="Definition.Untyped.html#3848" class="Function">suc</a> <a id="1290" class="Symbol">(</a><a id="1291" href="Erasure.Soundness.html#1227" class="Function">sucᵏ</a> <a id="1296" href="Erasure.Soundness.html#1281" class="Bound">n</a><a id="1297" class="Symbol">)</a>

<a id="sucᵏ′"></a><a id="1300" href="Erasure.Soundness.html#1300" class="Function">sucᵏ′</a> <a id="1306" class="Symbol">:</a> <a id="1308" class="Symbol">(</a><a id="1309" href="Erasure.Soundness.html#1309" class="Bound">k</a> <a id="1311" class="Symbol">:</a> <a id="1313" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a><a id="1316" class="Symbol">)</a> <a id="1318" class="Symbol">→</a> <a id="1320" href="Erasure.Target.html#302" class="Datatype">T.Term</a> <a id="1327" href="Erasure.Soundness.html#1064" class="Generalizable">n</a>
<a id="1329" href="Erasure.Soundness.html#1300" class="Function">sucᵏ′</a> <a id="1335" class="Number">0</a>      <a id="1342" class="Symbol">=</a> <a id="1344" href="Erasure.Target.html#441" class="InductiveConstructor">T.zero</a>
<a id="1351" href="Erasure.Soundness.html#1300" class="Function">sucᵏ′</a> <a id="1357" class="Symbol">(</a><a id="1358" href="Tools.Nat.html#406" class="InductiveConstructor">1+</a> <a id="1361" href="Erasure.Soundness.html#1361" class="Bound">n</a><a id="1362" class="Symbol">)</a> <a id="1364" class="Symbol">=</a> <a id="1366" href="Erasure.Target.html#462" class="InductiveConstructor">T.suc</a> <a id="1372" class="Symbol">(</a><a id="1373" href="Erasure.Soundness.html#1300" class="Function">sucᵏ′</a> <a id="1379" href="Erasure.Soundness.html#1361" class="Bound">n</a><a id="1380" class="Symbol">)</a>

<a id="1383" class="Comment">-- Weak head representation of natural numbers</a>

<a id="1431" class="Keyword">data</a> <a id="WHℕ"></a><a id="1436" href="Erasure.Soundness.html#1436" class="Datatype">WHℕ</a> <a id="1440" class="Symbol">:</a> <a id="1442" class="Symbol">(</a><a id="1443" href="Erasure.Soundness.html#1443" class="Bound">n</a> <a id="1445" class="Symbol">:</a> <a id="1447" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a><a id="1450" class="Symbol">)</a> <a id="1452" class="Symbol">→</a> <a id="1454" href="Definition.Untyped.html#2016" class="Datatype">Term</a> <a id="1459" class="Number">0</a> <a id="1461" class="Symbol">→</a> <a id="1463" class="PrimitiveType">Set</a> <a id="1467" class="Keyword">where</a>
  <a id="WHℕ.zeroʷ"></a><a id="1475" href="Erasure.Soundness.html#1475" class="InductiveConstructor">zeroʷ</a> <a id="1481" class="Symbol">:</a> <a id="1483" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="1485" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="1487" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="1489" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="1492" href="Definition.Untyped.html#3763" class="Function">zero</a> <a id="1497" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="1499" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="1501" class="Symbol">→</a> <a id="1503" href="Erasure.Soundness.html#1436" class="Datatype">WHℕ</a> <a id="1507" class="Number">0</a> <a id="1509" href="Erasure.Soundness.html#1076" class="Generalizable">t</a>
  <a id="WHℕ.sucʷ"></a><a id="1513" href="Erasure.Soundness.html#1513" class="InductiveConstructor">sucʷ</a>  <a id="1519" class="Symbol">:</a> <a id="1521" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="1523" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="1525" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="1527" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="1530" href="Definition.Untyped.html#3848" class="Function">suc</a> <a id="1534" href="Erasure.Soundness.html#1078" class="Generalizable">t′</a> <a id="1537" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="1539" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="1541" class="Symbol">→</a> <a id="1543" href="Erasure.Soundness.html#1436" class="Datatype">WHℕ</a> <a id="1547" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="1549" href="Erasure.Soundness.html#1078" class="Generalizable">t′</a> <a id="1552" class="Symbol">→</a> <a id="1554" href="Erasure.Soundness.html#1436" class="Datatype">WHℕ</a> <a id="1558" class="Symbol">(</a><a id="1559" href="Tools.Nat.html#406" class="InductiveConstructor">1+</a> <a id="1562" href="Erasure.Soundness.html#1064" class="Generalizable">n</a><a id="1563" class="Symbol">)</a> <a id="1565" href="Erasure.Soundness.html#1076" class="Generalizable">t</a>

<a id="1568" class="Keyword">data</a> <a id="WHℕ′"></a><a id="1573" href="Erasure.Soundness.html#1573" class="Datatype">WHℕ′</a> <a id="1578" class="Symbol">:</a> <a id="1580" class="Symbol">(</a><a id="1581" href="Erasure.Soundness.html#1581" class="Bound">n</a> <a id="1583" class="Symbol">:</a> <a id="1585" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a><a id="1588" class="Symbol">)</a> <a id="1590" class="Symbol">→</a> <a id="1592" href="Erasure.Target.html#302" class="Datatype">T.Term</a> <a id="1599" class="Number">0</a> <a id="1601" class="Symbol">→</a> <a id="1603" class="PrimitiveType">Set</a> <a id="1607" class="Keyword">where</a>
  <a id="WHℕ′.zeroʷ"></a><a id="1615" href="Erasure.Soundness.html#1615" class="InductiveConstructor">zeroʷ</a> <a id="1621" class="Symbol">:</a> <a id="1623" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="1625" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="1630" href="Erasure.Target.html#441" class="InductiveConstructor">T.zero</a> <a id="1637" class="Symbol">→</a> <a id="1639" href="Erasure.Soundness.html#1573" class="Datatype">WHℕ′</a> <a id="1644" class="Number">0</a> <a id="1646" href="Erasure.Soundness.html#1116" class="Generalizable">v</a>
  <a id="WHℕ′.sucʷ"></a><a id="1650" href="Erasure.Soundness.html#1650" class="InductiveConstructor">sucʷ</a>  <a id="1656" class="Symbol">:</a> <a id="1658" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="1660" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="1665" href="Erasure.Target.html#462" class="InductiveConstructor">T.suc</a> <a id="1671" href="Erasure.Soundness.html#1118" class="Generalizable">v′</a> <a id="1674" class="Symbol">→</a> <a id="1676" href="Erasure.Soundness.html#1573" class="Datatype">WHℕ′</a> <a id="1681" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="1683" href="Erasure.Soundness.html#1118" class="Generalizable">v′</a> <a id="1686" class="Symbol">→</a> <a id="1688" href="Erasure.Soundness.html#1573" class="Datatype">WHℕ′</a> <a id="1693" class="Symbol">(</a><a id="1694" href="Tools.Nat.html#406" class="InductiveConstructor">1+</a> <a id="1697" href="Erasure.Soundness.html#1064" class="Generalizable">n</a><a id="1698" class="Symbol">)</a> <a id="1700" href="Erasure.Soundness.html#1116" class="Generalizable">v</a>


<a id="1704" class="Comment">-- Weak head representations are equivallent to canonical representations</a>
<a id="1778" class="Comment">-- when reductions are allowed under the head of suc</a>

<a id="1832" class="Comment">-- If (∀ t t′ → ε ⊢ t ⇒* t′ ∷ ℕ → ε ⊢ suc t ⇒* suc t′ ∷ ℕ) and WHℕ n t</a>
<a id="1903" class="Comment">-- then ε ⊢ t ⇒* sucᵏ n ∷ ℕ</a>

<a id="WHℕ-canon"></a><a id="1932" href="Erasure.Soundness.html#1932" class="Function">WHℕ-canon</a> <a id="1942" class="Symbol">:</a> <a id="1944" class="Symbol">(∀</a> <a id="1947" class="Symbol">{</a><a id="1948" href="Erasure.Soundness.html#1948" class="Bound">t</a> <a id="1950" href="Erasure.Soundness.html#1950" class="Bound">t′</a><a id="1952" class="Symbol">}</a> <a id="1954" class="Symbol">→</a> <a id="1956" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="1958" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="1960" href="Erasure.Soundness.html#1948" class="Bound">t</a> <a id="1962" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="1965" href="Erasure.Soundness.html#1950" class="Bound">t′</a> <a id="1968" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="1970" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="1972" class="Symbol">→</a> <a id="1974" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="1976" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="1978" href="Definition.Untyped.html#3848" class="Function">suc</a> <a id="1982" href="Erasure.Soundness.html#1948" class="Bound">t</a> <a id="1984" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="1987" href="Definition.Untyped.html#3848" class="Function">suc</a> <a id="1991" href="Erasure.Soundness.html#1950" class="Bound">t′</a> <a id="1994" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="1996" href="Definition.Untyped.html#2808" class="Function">ℕ</a><a id="1997" class="Symbol">)</a>
              <a id="2013" class="Symbol">→</a> <a id="2015" href="Erasure.Soundness.html#1436" class="Datatype">WHℕ</a> <a id="2019" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="2021" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="2023" class="Symbol">→</a> <a id="2025" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="2027" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="2029" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="2031" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="2034" href="Erasure.Soundness.html#1227" class="Function">sucᵏ</a> <a id="2039" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="2041" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="2043" href="Definition.Untyped.html#2808" class="Function">ℕ</a>
<a id="2045" href="Erasure.Soundness.html#1932" class="Function">WHℕ-canon</a> <a id="2055" href="Erasure.Soundness.html#2055" class="Bound">red</a> <a id="2059" class="Symbol">(</a><a id="2060" href="Erasure.Soundness.html#1475" class="InductiveConstructor">zeroʷ</a> <a id="2066" href="Erasure.Soundness.html#2066" class="Bound">x</a><a id="2067" class="Symbol">)</a> <a id="2069" class="Symbol">=</a> <a id="2071" href="Erasure.Soundness.html#2066" class="Bound">x</a>
<a id="2073" href="Erasure.Soundness.html#1932" class="Function">WHℕ-canon</a> <a id="2083" href="Erasure.Soundness.html#2083" class="Bound">red</a> <a id="2087" class="Symbol">(</a><a id="2088" href="Erasure.Soundness.html#1513" class="InductiveConstructor">sucʷ</a> <a id="2093" href="Erasure.Soundness.html#2093" class="Bound">x</a> <a id="2095" href="Erasure.Soundness.html#2095" class="Bound">wh</a><a id="2097" class="Symbol">)</a> <a id="2099" class="Symbol">=</a> <a id="2101" href="Erasure.Soundness.html#2093" class="Bound">x</a> <a id="2103" href="Definition.Typed.RedSteps.html#489" class="Function Operator">⇨∷*</a> <a id="2107" class="Symbol">(</a><a id="2108" href="Erasure.Soundness.html#2083" class="Bound">red</a> <a id="2112" class="Symbol">(</a><a id="2113" href="Erasure.Soundness.html#1932" class="Function">WHℕ-canon</a> <a id="2123" href="Erasure.Soundness.html#2083" class="Bound">red</a> <a id="2127" href="Erasure.Soundness.html#2095" class="Bound">wh</a><a id="2129" class="Symbol">))</a>

<a id="2133" class="Comment">-- If (∀ v v′ → v ⇒* v′ → suc v ⇒* suc v′) and WHℕ′ n v</a>
<a id="2189" class="Comment">-- then v ⇒* sucᵏ′ v</a>

<a id="WHℕ′-canon"></a><a id="2211" href="Erasure.Soundness.html#2211" class="Function">WHℕ′-canon</a> <a id="2222" class="Symbol">:</a> <a id="2224" class="Symbol">(∀</a> <a id="2227" class="Symbol">{</a><a id="2228" href="Erasure.Soundness.html#2228" class="Bound">v</a> <a id="2230" href="Erasure.Soundness.html#2230" class="Bound">v′</a> <a id="2233" class="Symbol">:</a> <a id="2235" href="Erasure.Target.html#302" class="Datatype">T.Term</a> <a id="2242" class="Number">0</a><a id="2243" class="Symbol">}</a> <a id="2245" class="Symbol">→</a> <a id="2247" href="Erasure.Soundness.html#2228" class="Bound">v</a> <a id="2249" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="2254" href="Erasure.Soundness.html#2230" class="Bound">v′</a> <a id="2257" class="Symbol">→</a> <a id="2259" href="Erasure.Target.html#462" class="InductiveConstructor">T.suc</a> <a id="2265" href="Erasure.Soundness.html#2228" class="Bound">v</a> <a id="2267" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="2272" href="Erasure.Target.html#462" class="InductiveConstructor">T.suc</a> <a id="2278" href="Erasure.Soundness.html#2230" class="Bound">v′</a><a id="2280" class="Symbol">)</a>
           <a id="2293" class="Symbol">→</a> <a id="2295" href="Erasure.Soundness.html#1573" class="Datatype">WHℕ′</a> <a id="2300" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="2302" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="2304" class="Symbol">→</a> <a id="2306" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="2308" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="2313" href="Erasure.Soundness.html#1300" class="Function">sucᵏ′</a> <a id="2319" href="Erasure.Soundness.html#1064" class="Generalizable">n</a>
<a id="2321" href="Erasure.Soundness.html#2211" class="Function">WHℕ′-canon</a> <a id="2332" href="Erasure.Soundness.html#2332" class="Bound">red</a> <a id="2336" class="Symbol">(</a><a id="2337" href="Erasure.Soundness.html#1615" class="InductiveConstructor">zeroʷ</a> <a id="2343" href="Erasure.Soundness.html#2343" class="Bound">x</a><a id="2344" class="Symbol">)</a> <a id="2346" class="Symbol">=</a> <a id="2348" href="Erasure.Soundness.html#2343" class="Bound">x</a>
<a id="2350" href="Erasure.Soundness.html#2211" class="Function">WHℕ′-canon</a> <a id="2361" href="Erasure.Soundness.html#2361" class="Bound">red</a> <a id="2365" class="Symbol">(</a><a id="2366" href="Erasure.Soundness.html#1650" class="InductiveConstructor">sucʷ</a> <a id="2371" href="Erasure.Soundness.html#2371" class="Bound">x</a> <a id="2373" href="Erasure.Soundness.html#2373" class="Bound">wh</a><a id="2375" class="Symbol">)</a> <a id="2377" class="Symbol">=</a> <a id="2379" href="Erasure.Target.Properties.Reduction.html#343" class="Function">red*concat</a> <a id="2390" href="Erasure.Soundness.html#2371" class="Bound">x</a> <a id="2392" class="Symbol">(</a><a id="2393" href="Erasure.Soundness.html#2361" class="Bound">red</a> <a id="2397" class="Symbol">(</a><a id="2398" href="Erasure.Soundness.html#2211" class="Function">WHℕ′-canon</a> <a id="2409" href="Erasure.Soundness.html#2361" class="Bound">red</a> <a id="2413" href="Erasure.Soundness.html#2373" class="Bound">wh</a><a id="2415" class="Symbol">))</a>


<a id="2420" class="Comment">-- Helper lemma for WH reduction soundness of zero</a>
<a id="2471" class="Comment">-- If t ® v ∷ℕ  and t ⇒* zero then v ⇒* zero</a>

<a id="soundness-zero′"></a><a id="2517" href="Erasure.Soundness.html#2517" class="Function">soundness-zero′</a> <a id="2533" class="Symbol">:</a> <a id="2535" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="2537" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">®</a> <a id="2539" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="2541" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">∷ℕ</a> <a id="2544" class="Symbol">→</a> <a id="2546" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="2548" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="2550" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="2552" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="2555" href="Definition.Untyped.html#3763" class="Function">zero</a> <a id="2560" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="2562" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="2564" class="Symbol">→</a> <a id="2566" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="2568" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="2573" href="Erasure.Target.html#441" class="InductiveConstructor">T.zero</a>
<a id="2580" href="Erasure.Soundness.html#2517" class="Function">soundness-zero′</a> <a id="2596" class="Symbol">(</a><a id="2597" href="Erasure.LogicalRelation.html#1105" class="InductiveConstructor">zeroᵣ</a> <a id="2603" href="Erasure.Soundness.html#2603" class="Bound">t⇒zero′</a> <a id="2611" href="Erasure.Soundness.html#2611" class="Bound">v⇒zero</a> <a id="2618" class="Symbol">)</a> <a id="2620" href="Erasure.Soundness.html#2620" class="Bound">t⇒zero</a> <a id="2627" class="Symbol">=</a> <a id="2629" href="Erasure.Soundness.html#2611" class="Bound">v⇒zero</a>
<a id="2636" href="Erasure.Soundness.html#2517" class="Function">soundness-zero′</a> <a id="2652" class="Symbol">(</a><a id="2653" href="Erasure.LogicalRelation.html#1162" class="InductiveConstructor">sucᵣ</a> <a id="2658" href="Erasure.Soundness.html#2658" class="Bound">t⇒suc</a> <a id="2664" href="Erasure.Soundness.html#2664" class="Bound">v⇒suc</a> <a id="2670" href="Erasure.Soundness.html#2670" class="Bound">t®v</a><a id="2673" class="Symbol">)</a> <a id="2675" href="Erasure.Soundness.html#2675" class="Bound">t⇒zero</a> <a id="2682" class="Keyword">with</a> <a id="2687" href="Definition.Typed.Properties.html#10244" class="Function">whrDet*Term</a> <a id="2699" class="Symbol">(</a><a id="2700" href="Erasure.Soundness.html#2675" class="Bound">t⇒zero</a> <a id="2707" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2709" href="Definition.Untyped.html#5990" class="InductiveConstructor">zeroₙ</a><a id="2714" class="Symbol">)</a> <a id="2716" class="Symbol">(</a><a id="2717" href="Erasure.Soundness.html#2658" class="Bound">t⇒suc</a> <a id="2723" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2725" href="Definition.Untyped.html#6010" class="InductiveConstructor">sucₙ</a><a id="2729" class="Symbol">)</a>
<a id="2731" class="Symbol">...</a> <a id="2735" class="Symbol">|</a> <a id="2737" class="Symbol">()</a>

<a id="2741" class="Comment">-- WH reduction soundness of zero</a>
<a id="2775" class="Comment">-- If t ⇒* zero and ε ▸ t then erase t ⇒* zero</a>

<a id="soundness-zero"></a><a id="2823" href="Erasure.Soundness.html#2823" class="Function">soundness-zero</a> <a id="2838" class="Symbol">:</a> <a id="2840" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="2842" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="2844" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="2846" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="2849" href="Definition.Untyped.html#3763" class="Function">zero</a> <a id="2854" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="2856" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="2858" class="Symbol">→</a> <a id="2860" href="Definition.Modality.Context.html#619" class="InductiveConstructor">ε</a> <a id="2862" href="Definition.Modality.Usage.html#767" class="Datatype Operator">▸</a> <a id="2864" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="2866" class="Symbol">→</a> <a id="2868" href="Erasure.Extraction.html#444" class="Function">erase</a> <a id="2874" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="2876" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="2881" href="Erasure.Target.html#441" class="InductiveConstructor">T.zero</a>
<a id="2888" href="Erasure.Soundness.html#2823" class="Function">soundness-zero</a> <a id="2903" href="Erasure.Soundness.html#2903" class="Bound">t⇒zero</a> <a id="2910" href="Erasure.Soundness.html#2910" class="Bound">γ▸t</a> <a id="2914" class="Symbol">=</a>
  <a id="2918" class="Keyword">let</a> <a id="2922" href="Erasure.Soundness.html#2922" class="Bound">⊢t</a> <a id="2925" class="Symbol">=</a> <a id="2927" href="Definition.Typed.Properties.html#4570" class="Function">redFirst*Term</a> <a id="2941" href="Erasure.Soundness.html#2903" class="Bound">t⇒zero</a>
      <a id="2954" href="Erasure.Soundness.html#2954" class="Bound">[ℕ]</a> <a id="2958" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2960" href="Erasure.Soundness.html#2960" class="Bound">t®t′</a> <a id="2965" class="Symbol">=</a> <a id="2967" href="Erasure.LogicalRelation.Fundamental.html#11258" class="Function">fundamental′</a> <a id="2980" href="Erasure.Soundness.html#2922" class="Bound">⊢t</a> <a id="2983" href="Erasure.Soundness.html#2910" class="Bound">γ▸t</a>
      <a id="2993" href="Erasure.Soundness.html#2993" class="Bound">t®t″</a> <a id="2998" class="Symbol">=</a> <a id="3000" href="Erasure.LogicalRelation.Irrelevance.html#3924" class="Function">irrelevanceTerm</a> <a id="3016" class="Symbol">{</a><a id="3017" class="Argument">l′</a> <a id="3020" class="Symbol">=</a> <a id="3022" href="Definition.LogicalRelation.html#5591" class="InductiveConstructor">¹</a><a id="3023" class="Symbol">}</a> <a id="3025" href="Erasure.Soundness.html#2954" class="Bound">[ℕ]</a> <a id="3029" class="Symbol">(</a><a id="3030" href="Definition.LogicalRelation.html#12226" class="InductiveConstructor">ℕᵣ</a> <a id="3033" class="Symbol">(</a><a id="3034" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">[</a> <a id="3036" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="3039" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="3041" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="3043" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="3046" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="3048" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="3050" href="Definition.Typed.html#12568" class="InductiveConstructor">id</a> <a id="3053" class="Symbol">(</a><a id="3054" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="3057" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a><a id="3058" class="Symbol">)</a> <a id="3060" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">]</a><a id="3061" class="Symbol">))</a> <a id="3064" href="Erasure.Soundness.html#2960" class="Bound">t®t′</a>
  <a id="3071" class="Keyword">in</a>  <a id="3075" href="Erasure.Soundness.html#2517" class="Function">soundness-zero′</a> <a id="3091" href="Erasure.Soundness.html#2993" class="Bound">t®t″</a> <a id="3096" href="Erasure.Soundness.html#2903" class="Bound">t⇒zero</a>

<a id="3104" class="Comment">-- Helper lemma for WH reduction soundness of suc</a>
<a id="3154" class="Comment">-- If t ® v ∷ℕ  and t ⇒* suc t′ then v ⇒* suc v′ and t′ ® v′ ∷ℕ for some v′</a>

<a id="soundness-suc′"></a><a id="3231" href="Erasure.Soundness.html#3231" class="Function">soundness-suc′</a> <a id="3246" class="Symbol">:</a> <a id="3248" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="3250" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">®</a> <a id="3252" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="3254" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">∷ℕ</a> <a id="3257" class="Symbol">→</a> <a id="3259" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="3261" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="3263" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="3265" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="3268" href="Definition.Untyped.html#3848" class="Function">suc</a> <a id="3272" href="Erasure.Soundness.html#1078" class="Generalizable">t′</a> <a id="3275" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="3277" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="3279" class="Symbol">→</a> <a id="3281" href="Data.Product.html#1369" class="Function">∃</a> <a id="3283" class="Symbol">λ</a> <a id="3285" href="Erasure.Soundness.html#3285" class="Bound">v′</a> <a id="3288" class="Symbol">→</a> <a id="3290" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="3292" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="3297" href="Erasure.Target.html#462" class="InductiveConstructor">T.suc</a> <a id="3303" href="Erasure.Soundness.html#3285" class="Bound">v′</a> <a id="3306" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3308" href="Erasure.Soundness.html#1078" class="Generalizable">t′</a> <a id="3311" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">®</a> <a id="3313" href="Erasure.Soundness.html#3285" class="Bound">v′</a> <a id="3316" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">∷ℕ</a>
<a id="3319" href="Erasure.Soundness.html#3231" class="Function">soundness-suc′</a> <a id="3334" class="Symbol">(</a><a id="3335" href="Erasure.LogicalRelation.html#1105" class="InductiveConstructor">zeroᵣ</a> <a id="3341" href="Erasure.Soundness.html#3341" class="Bound">t⇒zero</a> <a id="3348" href="Erasure.Soundness.html#3348" class="Bound">v⇒zero</a><a id="3354" class="Symbol">)</a> <a id="3356" href="Erasure.Soundness.html#3356" class="Bound">t⇒suc</a>
  <a id="3364" class="Keyword">with</a> <a id="3369" href="Definition.Typed.Properties.html#10244" class="Function">whrDet*Term</a> <a id="3381" class="Symbol">(</a><a id="3382" href="Erasure.Soundness.html#3341" class="Bound">t⇒zero</a> <a id="3389" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3391" href="Definition.Untyped.html#5990" class="InductiveConstructor">zeroₙ</a><a id="3396" class="Symbol">)</a> <a id="3398" class="Symbol">(</a><a id="3399" href="Erasure.Soundness.html#3356" class="Bound">t⇒suc</a> <a id="3405" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3407" href="Definition.Untyped.html#6010" class="InductiveConstructor">sucₙ</a><a id="3411" class="Symbol">)</a>
<a id="3413" class="Symbol">...</a> <a id="3417" class="Symbol">|</a> <a id="3419" class="Symbol">()</a>
<a id="3422" href="Erasure.Soundness.html#3231" class="Function">soundness-suc′</a> <a id="3437" class="Symbol">(</a><a id="3438" href="Erasure.LogicalRelation.html#1162" class="InductiveConstructor">sucᵣ</a> <a id="3443" class="Symbol">{</a><a id="3444" class="Argument">v′</a> <a id="3447" class="Symbol">=</a> <a id="3449" href="Erasure.Soundness.html#3449" class="Bound">v′</a><a id="3451" class="Symbol">}</a> <a id="3453" href="Erasure.Soundness.html#3453" class="Bound">t⇒suc′</a> <a id="3460" href="Erasure.Soundness.html#3460" class="Bound">v⇒suc</a> <a id="3466" href="Erasure.Soundness.html#3466" class="Bound">t®v</a><a id="3469" class="Symbol">)</a> <a id="3471" href="Erasure.Soundness.html#3471" class="Bound">t⇒suc</a>
  <a id="3479" class="Keyword">with</a> <a id="3484" href="Definition.Typed.Properties.html#10244" class="Function">whrDet*Term</a> <a id="3496" class="Symbol">(</a><a id="3497" href="Erasure.Soundness.html#3471" class="Bound">t⇒suc</a> <a id="3503" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3505" href="Definition.Untyped.html#6010" class="InductiveConstructor">sucₙ</a><a id="3509" class="Symbol">)</a> <a id="3511" class="Symbol">(</a><a id="3512" href="Erasure.Soundness.html#3453" class="Bound">t⇒suc′</a> <a id="3519" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3521" href="Definition.Untyped.html#6010" class="InductiveConstructor">sucₙ</a><a id="3525" class="Symbol">)</a>
<a id="3527" class="Symbol">...</a> <a id="3531" class="Symbol">|</a> <a id="3533" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3538" class="Symbol">=</a> <a id="3540" class="Bound">v′</a> <a id="3543" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3545" class="Symbol">(</a><a id="3546" class="Bound">v⇒suc</a> <a id="3552" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3554" class="Bound">t®v</a><a id="3557" class="Symbol">)</a>

<a id="3560" class="Comment">-- WH reduction soundness of suc</a>
<a id="3593" class="Comment">-- If t ⇒* suc t′ and ε ▸ t then erase t ⇒* suc v′ and t′ ® v′ ∷ℕ for some v′</a>

<a id="soundness-suc"></a><a id="3672" href="Erasure.Soundness.html#3672" class="Function">soundness-suc</a> <a id="3686" class="Symbol">:</a> <a id="3688" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="3690" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="3692" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="3694" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="3697" href="Definition.Untyped.html#3848" class="Function">suc</a> <a id="3701" href="Erasure.Soundness.html#1078" class="Generalizable">t′</a> <a id="3704" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="3706" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="3708" class="Symbol">→</a> <a id="3710" href="Definition.Modality.Context.html#619" class="InductiveConstructor">ε</a> <a id="3712" href="Definition.Modality.Usage.html#767" class="Datatype Operator">▸</a> <a id="3714" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="3716" class="Symbol">→</a> <a id="3718" href="Data.Product.html#1369" class="Function">∃</a> <a id="3720" class="Symbol">λ</a> <a id="3722" href="Erasure.Soundness.html#3722" class="Bound">v′</a> <a id="3725" class="Symbol">→</a> <a id="3727" href="Erasure.Extraction.html#444" class="Function">erase</a> <a id="3733" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="3735" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="3740" href="Erasure.Target.html#462" class="InductiveConstructor">T.suc</a> <a id="3746" href="Erasure.Soundness.html#3722" class="Bound">v′</a> <a id="3749" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3751" href="Erasure.Soundness.html#1078" class="Generalizable">t′</a> <a id="3754" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">®</a> <a id="3756" href="Erasure.Soundness.html#3722" class="Bound">v′</a> <a id="3759" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">∷ℕ</a>
<a id="3762" href="Erasure.Soundness.html#3672" class="Function">soundness-suc</a> <a id="3776" href="Erasure.Soundness.html#3776" class="Bound">t⇒suc</a> <a id="3782" href="Erasure.Soundness.html#3782" class="Bound">γ▸t</a> <a id="3786" class="Symbol">=</a>
  <a id="3790" class="Keyword">let</a> <a id="3794" href="Erasure.Soundness.html#3794" class="Bound">⊢t</a> <a id="3797" class="Symbol">=</a> <a id="3799" href="Definition.Typed.Properties.html#4570" class="Function">redFirst*Term</a> <a id="3813" href="Erasure.Soundness.html#3776" class="Bound">t⇒suc</a>
      <a id="3825" href="Erasure.Soundness.html#3825" class="Bound">[ℕ]</a> <a id="3829" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3831" href="Erasure.Soundness.html#3831" class="Bound">t®t′</a> <a id="3836" class="Symbol">=</a> <a id="3838" href="Erasure.LogicalRelation.Fundamental.html#11258" class="Function">fundamental′</a> <a id="3851" href="Erasure.Soundness.html#3794" class="Bound">⊢t</a> <a id="3854" href="Erasure.Soundness.html#3782" class="Bound">γ▸t</a>
      <a id="3864" href="Erasure.Soundness.html#3864" class="Bound">t®t″</a> <a id="3869" class="Symbol">=</a> <a id="3871" href="Erasure.LogicalRelation.Irrelevance.html#3924" class="Function">irrelevanceTerm</a> <a id="3887" class="Symbol">{</a><a id="3888" class="Argument">l′</a> <a id="3891" class="Symbol">=</a> <a id="3893" href="Definition.LogicalRelation.html#5591" class="InductiveConstructor">¹</a><a id="3894" class="Symbol">}</a> <a id="3896" href="Erasure.Soundness.html#3825" class="Bound">[ℕ]</a> <a id="3900" class="Symbol">(</a><a id="3901" href="Definition.LogicalRelation.html#12226" class="InductiveConstructor">ℕᵣ</a> <a id="3904" class="Symbol">(</a><a id="3905" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">[</a> <a id="3907" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="3910" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="3912" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="3914" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="3917" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="3919" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="3921" href="Definition.Typed.html#12568" class="InductiveConstructor">id</a> <a id="3924" class="Symbol">(</a><a id="3925" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="3928" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a><a id="3929" class="Symbol">)</a> <a id="3931" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">]</a><a id="3932" class="Symbol">))</a> <a id="3935" href="Erasure.Soundness.html#3831" class="Bound">t®t′</a>
  <a id="3942" class="Keyword">in</a>  <a id="3946" href="Erasure.Soundness.html#3231" class="Function">soundness-suc′</a> <a id="3961" href="Erasure.Soundness.html#3864" class="Bound">t®t″</a> <a id="3966" href="Erasure.Soundness.html#3776" class="Bound">t⇒suc</a>


<a id="3974" class="Comment">-- Helper lemma for WH reduction soundness of natural numbers</a>
<a id="4036" class="Comment">-- If t ® v ∷ℕ and WHℕ n t then WHℕ′ n v</a>

<a id="soundness-ℕ′"></a><a id="4078" href="Erasure.Soundness.html#4078" class="Function">soundness-ℕ′</a> <a id="4091" class="Symbol">:</a> <a id="4093" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4095" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">®</a> <a id="4097" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="4099" href="Erasure.LogicalRelation.html#1055" class="Datatype Operator">∷ℕ</a> <a id="4102" class="Symbol">→</a> <a id="4104" href="Erasure.Soundness.html#1436" class="Datatype">WHℕ</a> <a id="4108" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="4110" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4112" class="Symbol">→</a> <a id="4114" href="Erasure.Soundness.html#1573" class="Datatype">WHℕ′</a> <a id="4119" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="4121" href="Erasure.Soundness.html#1116" class="Generalizable">v</a>
<a id="4123" href="Erasure.Soundness.html#4078" class="Function">soundness-ℕ′</a> <a id="4136" href="Erasure.Soundness.html#4136" class="Bound">t®v</a> <a id="4140" class="Symbol">(</a><a id="4141" href="Erasure.Soundness.html#1475" class="InductiveConstructor">zeroʷ</a> <a id="4147" href="Erasure.Soundness.html#4147" class="Bound">x</a><a id="4148" class="Symbol">)</a> <a id="4150" class="Symbol">=</a> <a id="4152" href="Erasure.Soundness.html#1615" class="InductiveConstructor">zeroʷ</a> <a id="4158" class="Symbol">(</a><a id="4159" href="Erasure.Soundness.html#2517" class="Function">soundness-zero′</a> <a id="4175" href="Erasure.Soundness.html#4136" class="Bound">t®v</a> <a id="4179" href="Erasure.Soundness.html#4147" class="Bound">x</a><a id="4180" class="Symbol">)</a>
<a id="4182" href="Erasure.Soundness.html#4078" class="Function">soundness-ℕ′</a> <a id="4195" href="Erasure.Soundness.html#4195" class="Bound">t®v</a> <a id="4199" class="Symbol">(</a><a id="4200" href="Erasure.Soundness.html#1513" class="InductiveConstructor">sucʷ</a> <a id="4205" href="Erasure.Soundness.html#4205" class="Bound">x</a> <a id="4207" href="Erasure.Soundness.html#4207" class="Bound">whn</a><a id="4210" class="Symbol">)</a> <a id="4212" class="Symbol">=</a>
  <a id="4216" class="Keyword">let</a> <a id="4220" href="Erasure.Soundness.html#4220" class="Bound">v′</a> <a id="4223" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4225" href="Erasure.Soundness.html#4225" class="Bound">v⇒suc</a> <a id="4231" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4233" href="Erasure.Soundness.html#4233" class="Bound">t®v′</a> <a id="4238" class="Symbol">=</a> <a id="4240" href="Erasure.Soundness.html#3231" class="Function">soundness-suc′</a> <a id="4255" href="Erasure.Soundness.html#4195" class="Bound">t®v</a> <a id="4259" href="Erasure.Soundness.html#4205" class="Bound">x</a>
  <a id="4263" class="Keyword">in</a>  <a id="4267" href="Erasure.Soundness.html#1650" class="InductiveConstructor">sucʷ</a> <a id="4272" href="Erasure.Soundness.html#4225" class="Bound">v⇒suc</a> <a id="4278" class="Symbol">(</a><a id="4279" href="Erasure.Soundness.html#4078" class="Function">soundness-ℕ′</a> <a id="4292" href="Erasure.Soundness.html#4233" class="Bound">t®v′</a> <a id="4297" href="Erasure.Soundness.html#4207" class="Bound">whn</a><a id="4300" class="Symbol">)</a>

<a id="4303" class="Comment">-- WH reduction soundness of natural numbers</a>
<a id="4348" class="Comment">-- If t ® v ∷ℕ and WHℕ n t then WHℕ′ n v</a>

<a id="soundness-ℕ"></a><a id="4390" href="Erasure.Soundness.html#4390" class="Function">soundness-ℕ</a> <a id="4402" class="Symbol">:</a> <a id="4404" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="4406" href="Definition.Typed.html#1231" class="Datatype Operator">⊢</a> <a id="4408" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4410" href="Definition.Typed.html#1231" class="Datatype Operator">∷</a> <a id="4412" href="Definition.Untyped.html#2808" class="Function">ℕ</a> <a id="4414" class="Symbol">→</a> <a id="4416" href="Definition.Modality.Context.html#619" class="InductiveConstructor">ε</a> <a id="4418" href="Definition.Modality.Usage.html#767" class="Datatype Operator">▸</a> <a id="4420" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4422" class="Symbol">→</a> <a id="4424" href="Erasure.Soundness.html#1436" class="Datatype">WHℕ</a> <a id="4428" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="4430" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4432" class="Symbol">→</a> <a id="4434" href="Erasure.Soundness.html#1573" class="Datatype">WHℕ′</a> <a id="4439" href="Erasure.Soundness.html#1064" class="Generalizable">n</a> <a id="4441" class="Symbol">(</a><a id="4442" href="Erasure.Extraction.html#444" class="Function">erase</a> <a id="4448" href="Erasure.Soundness.html#1076" class="Generalizable">t</a><a id="4449" class="Symbol">)</a>
<a id="4451" href="Erasure.Soundness.html#4390" class="Function">soundness-ℕ</a> <a id="4463" href="Erasure.Soundness.html#4463" class="Bound">⊢t</a> <a id="4466" href="Erasure.Soundness.html#4466" class="Bound">γ▸t</a> <a id="4470" href="Erasure.Soundness.html#4470" class="Bound">whn</a> <a id="4474" class="Symbol">=</a>
  <a id="4478" class="Keyword">let</a> <a id="4482" href="Erasure.Soundness.html#4482" class="Bound">[ℕ]</a> <a id="4486" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4488" href="Erasure.Soundness.html#4488" class="Bound">t®t′</a> <a id="4493" class="Symbol">=</a> <a id="4495" href="Erasure.LogicalRelation.Fundamental.html#11258" class="Function">fundamental′</a> <a id="4508" href="Erasure.Soundness.html#4463" class="Bound">⊢t</a> <a id="4511" href="Erasure.Soundness.html#4466" class="Bound">γ▸t</a>
      <a id="4521" href="Erasure.Soundness.html#4521" class="Bound">t®t″</a> <a id="4526" class="Symbol">=</a> <a id="4528" href="Erasure.LogicalRelation.Irrelevance.html#3924" class="Function">irrelevanceTerm</a> <a id="4544" class="Symbol">{</a><a id="4545" class="Argument">l′</a> <a id="4548" class="Symbol">=</a> <a id="4550" href="Definition.LogicalRelation.html#5591" class="InductiveConstructor">¹</a><a id="4551" class="Symbol">}</a> <a id="4553" href="Erasure.Soundness.html#4482" class="Bound">[ℕ]</a> <a id="4557" class="Symbol">(</a><a id="4558" href="Definition.LogicalRelation.html#12226" class="InductiveConstructor">ℕᵣ</a> <a id="4561" class="Symbol">(</a><a id="4562" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">[</a> <a id="4564" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="4567" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="4569" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="4571" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="4574" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="4576" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="4578" href="Definition.Typed.html#12568" class="InductiveConstructor">id</a> <a id="4581" class="Symbol">(</a><a id="4582" href="Definition.Typed.html#909" class="InductiveConstructor">ℕⱼ</a> <a id="4585" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a><a id="4586" class="Symbol">)</a> <a id="4588" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">]</a><a id="4589" class="Symbol">))</a> <a id="4592" href="Erasure.Soundness.html#4488" class="Bound">t®t′</a>
  <a id="4599" class="Keyword">in</a>  <a id="4603" href="Erasure.Soundness.html#4078" class="Function">soundness-ℕ′</a> <a id="4616" href="Erasure.Soundness.html#4521" class="Bound">t®t″</a> <a id="4621" href="Erasure.Soundness.html#4470" class="Bound">whn</a>


<a id="4627" class="Comment">-- Helper lemma for WH reduction soundness of unit</a>

<a id="soundness-star′"></a><a id="4679" href="Erasure.Soundness.html#4679" class="Function">soundness-star′</a> <a id="4695" class="Symbol">:</a> <a id="4697" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4699" href="Erasure.LogicalRelation.html#1297" class="Datatype Operator">®</a> <a id="4701" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="4703" href="Erasure.LogicalRelation.html#1297" class="Datatype Operator">∷Unit</a> <a id="4709" class="Symbol">→</a> <a id="4711" href="Erasure.Soundness.html#1116" class="Generalizable">v</a> <a id="4713" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="4718" href="Erasure.Target.html#739" class="InductiveConstructor">T.star</a>
<a id="4725" href="Erasure.Soundness.html#4679" class="Function">soundness-star′</a> <a id="4741" class="Symbol">(</a><a id="4742" href="Erasure.LogicalRelation.html#1350" class="InductiveConstructor">starᵣ</a> <a id="4748" class="Symbol">_</a> <a id="4750" href="Erasure.Soundness.html#4750" class="Bound">v⇒star</a><a id="4756" class="Symbol">)</a> <a id="4758" class="Symbol">=</a> <a id="4760" href="Erasure.Soundness.html#4750" class="Bound">v⇒star</a>

<a id="4768" class="Comment">-- WH reduction soundness of unit</a>

<a id="soundness-star"></a><a id="4803" href="Erasure.Soundness.html#4803" class="Function">soundness-star</a> <a id="4818" class="Symbol">:</a> <a id="4820" href="Definition.Untyped.html#746" class="InductiveConstructor">ε</a> <a id="4822" href="Definition.Typed.html#12262" class="Datatype Operator">⊢</a> <a id="4824" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4826" href="Definition.Typed.html#12262" class="Datatype Operator">⇒*</a> <a id="4829" href="Definition.Untyped.html#4143" class="Function">star</a> <a id="4834" href="Definition.Typed.html#12262" class="Datatype Operator">∷</a> <a id="4836" href="Definition.Untyped.html#2970" class="Function">Unit</a> <a id="4841" class="Symbol">→</a> <a id="4843" href="Definition.Modality.Context.html#619" class="InductiveConstructor">ε</a> <a id="4845" href="Definition.Modality.Usage.html#767" class="Datatype Operator">▸</a> <a id="4847" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4849" class="Symbol">→</a> <a id="4851" href="Erasure.Extraction.html#444" class="Function">erase</a> <a id="4857" href="Erasure.Soundness.html#1076" class="Generalizable">t</a> <a id="4859" href="Erasure.Target.html#5172" class="Datatype Operator">T.⇒*</a> <a id="4864" href="Erasure.Target.html#739" class="InductiveConstructor">T.star</a>
<a id="4871" href="Erasure.Soundness.html#4803" class="Function">soundness-star</a> <a id="4886" href="Erasure.Soundness.html#4886" class="Bound">t⇒star</a> <a id="4893" href="Erasure.Soundness.html#4893" class="Bound">γ▸t</a> <a id="4897" class="Symbol">=</a>
  <a id="4901" class="Keyword">let</a> <a id="4905" href="Erasure.Soundness.html#4905" class="Bound">⊢t</a> <a id="4908" class="Symbol">=</a> <a id="4910" href="Definition.Typed.Properties.html#4570" class="Function">redFirst*Term</a> <a id="4924" href="Erasure.Soundness.html#4886" class="Bound">t⇒star</a>
      <a id="4937" href="Erasure.Soundness.html#4937" class="Bound">[⊤]</a> <a id="4941" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4943" href="Erasure.Soundness.html#4943" class="Bound">t®t′</a> <a id="4948" class="Symbol">=</a> <a id="4950" href="Erasure.LogicalRelation.Fundamental.html#11258" class="Function">fundamental′</a> <a id="4963" href="Erasure.Soundness.html#4905" class="Bound">⊢t</a> <a id="4966" href="Erasure.Soundness.html#4893" class="Bound">γ▸t</a>
      <a id="4976" href="Erasure.Soundness.html#4976" class="Bound">t®t″</a> <a id="4981" class="Symbol">=</a> <a id="4983" href="Erasure.LogicalRelation.Irrelevance.html#3924" class="Function">irrelevanceTerm</a> <a id="4999" class="Symbol">{</a><a id="5000" class="Argument">l′</a> <a id="5003" class="Symbol">=</a> <a id="5005" href="Definition.LogicalRelation.html#5591" class="InductiveConstructor">¹</a><a id="5006" class="Symbol">}</a> <a id="5008" href="Erasure.Soundness.html#4937" class="Bound">[⊤]</a> <a id="5012" class="Symbol">(</a><a id="5013" href="Definition.LogicalRelation.html#12305" class="InductiveConstructor">Unitᵣ</a> <a id="5019" class="Symbol">(</a><a id="5020" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">[</a> <a id="5022" href="Definition.Typed.html#963" class="InductiveConstructor">Unitⱼ</a> <a id="5028" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="5030" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="5032" href="Definition.Typed.html#963" class="InductiveConstructor">Unitⱼ</a> <a id="5038" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a> <a id="5040" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">,</a> <a id="5042" href="Definition.Typed.html#12568" class="InductiveConstructor">id</a> <a id="5045" class="Symbol">(</a><a id="5046" href="Definition.Typed.html#963" class="InductiveConstructor">Unitⱼ</a> <a id="5052" href="Definition.Typed.html#750" class="InductiveConstructor">ε</a><a id="5053" class="Symbol">)</a> <a id="5055" href="Definition.Typed.html#13351" class="InductiveConstructor Operator">]</a><a id="5056" class="Symbol">))</a> <a id="5059" href="Erasure.Soundness.html#4943" class="Bound">t®t′</a>
  <a id="5066" class="Keyword">in</a>  <a id="5070" href="Erasure.Soundness.html#4679" class="Function">soundness-star′</a> <a id="5086" href="Erasure.Soundness.html#4976" class="Bound">t®t″</a>
</pre></body></html>